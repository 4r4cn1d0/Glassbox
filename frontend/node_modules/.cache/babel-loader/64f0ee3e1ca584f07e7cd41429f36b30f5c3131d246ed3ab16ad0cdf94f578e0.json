{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\aayus\\\\Glassbox\\\\frontend\\\\src\\\\AttentionSpiderWeb.tsx\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect } from 'react';\nimport { Paper, Typography } from '@mui/material';\nimport * as d3 from 'd3';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AttentionSpiderWeb = ({\n  attention,\n  tokens,\n  selectedLayer,\n  selectedHead\n}) => {\n  _s();\n  const svgRef = useRef(null);\n  useEffect(() => {\n    var _attentionData$2;\n    if (!svgRef.current || !attention.length || !tokens.length) {\n      console.log('SpiderWeb: Missing basic requirements', {\n        svgRef: !!svgRef.current,\n        attentionLength: attention.length,\n        tokensLength: tokens.length\n      });\n      return;\n    }\n    console.log('SpiderWeb: Starting render', {\n      selectedLayer,\n      selectedHead,\n      attentionShape: attention.length,\n      tokens: tokens.slice(0, 5) // Log first 5 tokens\n    });\n\n    // Clear previous render\n    const svg = d3.select(svgRef.current);\n    svg.selectAll(\"*\").remove();\n    const width = 800;\n    const height = 600;\n    const centerX = width / 2;\n    const centerY = height / 2;\n    const radius = Math.min(width, height) / 2 - 80;\n\n    // Safely extract attention data with runtime validation\n    let attentionData = [];\n    try {\n      console.log('SpiderWeb: Checking attention data structure');\n      if (attention[selectedLayer]) {\n        console.log('SpiderWeb: Layer exists, heads:', attention[selectedLayer].length);\n        if (attention[selectedLayer][selectedHead]) {\n          const rawData = attention[selectedLayer][selectedHead];\n          console.log('SpiderWeb: Raw attention data:', {\n            type: typeof rawData,\n            isArray: Array.isArray(rawData),\n            length: Array.isArray(rawData) ? rawData.length : 'N/A',\n            firstElement: Array.isArray(rawData) && rawData[0] ? typeof rawData[0] : 'N/A'\n          });\n\n          // Check if it's already a 2D array\n          if (Array.isArray(rawData) && rawData.length > 0) {\n            if (Array.isArray(rawData[0])) {\n              var _attentionData$;\n              // It's already 2D - explicitly cast to avoid TypeScript error\n              attentionData = rawData;\n              console.log('SpiderWeb: Using 2D attention data, shape:', attentionData.length, 'x', (_attentionData$ = attentionData[0]) === null || _attentionData$ === void 0 ? void 0 : _attentionData$.length);\n            } else {\n              // It might be 1D, let's try to handle it\n              console.log('SpiderWeb: Data appears to be 1D, attempting to create identity matrix');\n              const numTokens = Math.min(rawData.length, tokens.length);\n              attentionData = Array(numTokens).fill(0).map(() => Array(numTokens).fill(0));\n              // Create some sample connections for testing\n              for (let i = 0; i < numTokens - 1; i++) {\n                attentionData[i][i + 1] = 0.5; // Forward connections\n                if (i > 0) attentionData[i][i - 1] = 0.3; // Backward connections\n              }\n            }\n          } else {\n            console.warn('SpiderWeb: Invalid attention data format');\n            return;\n          }\n        } else {\n          console.warn('SpiderWeb: Head not found');\n          return;\n        }\n      } else {\n        console.warn('SpiderWeb: Layer not found');\n        return;\n      }\n    } catch (error) {\n      console.error('SpiderWeb: Error processing attention data:', error);\n      return;\n    }\n    if (attentionData.length === 0) {\n      console.warn('SpiderWeb: No attention data to visualize');\n      return;\n    }\n    console.log('SpiderWeb: Successfully processed attention data, shape:', attentionData.length, 'x', (_attentionData$2 = attentionData[0]) === null || _attentionData$2 === void 0 ? void 0 : _attentionData$2.length);\n\n    // Position tokens in a circle\n    const tokenPositions = tokens.map((token, i) => {\n      const angle = 2 * Math.PI * i / tokens.length - Math.PI / 2;\n      return {\n        x: centerX + radius * Math.cos(angle),\n        y: centerY + radius * Math.sin(angle),\n        token: token,\n        index: i\n      };\n    });\n    console.log('SpiderWeb: Token positions calculated:', tokenPositions.length);\n\n    // Create container group\n    const g = svg.append('g');\n\n    // Find maximum attention value for scaling\n    let maxAttention = 0;\n    let connectionCount = 0;\n    for (let i = 0; i < attentionData.length; i++) {\n      const row = attentionData[i];\n      if (Array.isArray(row)) {\n        for (let j = 0; j < row.length; j++) {\n          const val = row[j];\n          if (typeof val === 'number' && !isNaN(val) && val > maxAttention) {\n            maxAttention = val;\n          }\n          if (typeof val === 'number' && !isNaN(val) && val > 0) {\n            connectionCount++;\n          }\n        }\n      }\n    }\n    console.log('SpiderWeb: Max attention:', maxAttention, 'Total connections:', connectionCount);\n    if (maxAttention === 0) {\n      console.warn('SpiderWeb: No positive attention values found');\n      // Let's add some test connections to verify the visualization works\n      maxAttention = 1.0;\n      attentionData[0][1] = 0.8;\n      attentionData[1][2] = 0.6;\n      if (attentionData.length > 2) {\n        attentionData[2][0] = 0.4;\n      }\n      console.log('SpiderWeb: Added test connections');\n    }\n    const minThreshold = maxAttention * 0.05; // Only show connections above 5% of max\n    let drawnConnections = 0;\n\n    // Draw attention connections\n    for (let fromIdx = 0; fromIdx < attentionData.length && fromIdx < tokenPositions.length; fromIdx++) {\n      const fromAttentions = attentionData[fromIdx];\n      if (!Array.isArray(fromAttentions)) continue;\n      for (let toIdx = 0; toIdx < fromAttentions.length && toIdx < tokenPositions.length; toIdx++) {\n        const attentionWeight = fromAttentions[toIdx];\n        if (typeof attentionWeight !== 'number' || isNaN(attentionWeight)) continue;\n        if (attentionWeight <= minThreshold) continue;\n        const from = tokenPositions[fromIdx];\n        const to = tokenPositions[toIdx];\n        const opacity = Math.min(1, attentionWeight / maxAttention);\n        const strokeWidth = Math.max(1, opacity * 8);\n        g.append('line').attr('x1', from.x).attr('y1', from.y).attr('x2', to.x).attr('y2', to.y).attr('stroke', `rgba(33, 150, 243, ${opacity})`).attr('stroke-width', strokeWidth).attr('class', 'attention-connection').style('pointer-events', 'none');\n        drawnConnections++;\n      }\n    }\n    console.log('SpiderWeb: Drew', drawnConnections, 'connections');\n\n    // Always draw token nodes\n    const nodes = g.selectAll('.token-node').data(tokenPositions).enter().append('g').attr('class', 'token-node').attr('transform', d => `translate(${d.x}, ${d.y})`);\n\n    // Add circles for tokens\n    nodes.append('circle').attr('r', 20).attr('fill', '#2196F3').attr('stroke', '#fff').attr('stroke-width', 2).style('cursor', 'pointer');\n\n    // Add token text\n    nodes.append('text').text(d => d.token.length > 6 ? d.token.substring(0, 6) + '...' : d.token).attr('text-anchor', 'middle').attr('dy', '0.3em').attr('fill', '#fff').attr('font-size', '10px').attr('font-weight', 'bold').style('pointer-events', 'none');\n    console.log('SpiderWeb: Drew', tokenPositions.length, 'token nodes');\n\n    // Add hover effects\n    nodes.on('mouseover', function (event, d) {\n      d3.select(this).select('circle').transition().duration(200).attr('r', 25).attr('fill', '#21CBF3');\n\n      // Show tooltip\n      d3.select('body').append('div').attr('class', 'spider-tooltip').style('position', 'absolute').style('background', 'rgba(0, 0, 0, 0.8)').style('color', '#fff').style('padding', '8px').style('border-radius', '4px').style('font-size', '12px').style('pointer-events', 'none').style('z-index', '1000').style('left', event.pageX + 10 + 'px').style('top', event.pageY - 10 + 'px').text(`Token: \"${d.token}\" (Position: ${d.index})`);\n    }).on('mouseout', function () {\n      d3.select(this).select('circle').transition().duration(200).attr('r', 20).attr('fill', '#2196F3');\n      d3.selectAll('.spider-tooltip').remove();\n    });\n\n    // Add center label\n    g.append('text').attr('x', centerX).attr('y', centerY - 10).attr('text-anchor', 'middle').attr('fill', '#aaa').attr('font-size', '14px').text(`Layer ${selectedLayer + 1}, Head ${selectedHead + 1}`);\n    g.append('text').attr('x', centerX).attr('y', centerY + 10).attr('text-anchor', 'middle').attr('fill', '#aaa').attr('font-size', '12px').text('Attention Flow Network');\n    console.log('SpiderWeb: Visualization complete');\n  }, [attention, tokens, selectedLayer, selectedHead]);\n  return /*#__PURE__*/_jsxDEV(Paper, {\n    elevation: 2,\n    sx: {\n      p: 2,\n      mb: 3,\n      bgcolor: '#1e1e1e',\n      border: '1px solid #333'\n    },\n    children: [/*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"h6\",\n      sx: {\n        mb: 2,\n        color: '#fff'\n      },\n      children: \"Attention Spider Web\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"body2\",\n      sx: {\n        mb: 2,\n        color: '#aaa'\n      },\n      children: \"Network visualization showing attention connections between tokens. Line thickness and opacity represent attention strength.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 292,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"svg\", {\n      ref: svgRef,\n      width: \"100%\",\n      height: \"600\",\n      viewBox: \"0 0 800 600\",\n      style: {\n        background: '#0a0a0a',\n        borderRadius: '4px'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 280,\n    columnNumber: 5\n  }, this);\n};\n_s(AttentionSpiderWeb, \"89Ty783ABEwsfMbSOeu9vscWF34=\");\n_c = AttentionSpiderWeb;\nexport default AttentionSpiderWeb;\nvar _c;\n$RefreshReg$(_c, \"AttentionSpiderWeb\");","map":{"version":3,"names":["React","useRef","useEffect","Paper","Typography","d3","jsxDEV","_jsxDEV","AttentionSpiderWeb","attention","tokens","selectedLayer","selectedHead","_s","svgRef","_attentionData$2","current","length","console","log","attentionLength","tokensLength","attentionShape","slice","svg","select","selectAll","remove","width","height","centerX","centerY","radius","Math","min","attentionData","rawData","type","isArray","Array","firstElement","_attentionData$","numTokens","fill","map","i","warn","error","tokenPositions","token","angle","PI","x","cos","y","sin","index","g","append","maxAttention","connectionCount","row","j","val","isNaN","minThreshold","drawnConnections","fromIdx","fromAttentions","toIdx","attentionWeight","from","to","opacity","strokeWidth","max","attr","style","nodes","data","enter","d","text","substring","on","event","transition","duration","pageX","pageY","elevation","sx","p","mb","bgcolor","border","children","variant","color","fileName","_jsxFileName","lineNumber","columnNumber","ref","viewBox","background","borderRadius","_c","$RefreshReg$"],"sources":["C:/Users/aayus/Glassbox/frontend/src/AttentionSpiderWeb.tsx"],"sourcesContent":["import React, { useRef, useEffect } from 'react';\r\nimport { Paper, Typography } from '@mui/material';\r\nimport * as d3 from 'd3';\r\n\r\ninterface AttentionSpiderWebProps {\r\n  attention: number[][][]; // [layer][head][from_token][to_token]\r\n  tokens: string[];\r\n  selectedLayer: number;\r\n  selectedHead: number;\r\n}\r\n\r\ninterface TokenPosition {\r\n  x: number;\r\n  y: number;\r\n  token: string;\r\n  index: number;\r\n}\r\n\r\nconst AttentionSpiderWeb: React.FC<AttentionSpiderWebProps> = ({\r\n  attention,\r\n  tokens,\r\n  selectedLayer,\r\n  selectedHead\r\n}) => {\r\n  const svgRef = useRef<SVGSVGElement>(null);\r\n\r\n  useEffect(() => {\r\n    if (!svgRef.current || !attention.length || !tokens.length) {\r\n      console.log('SpiderWeb: Missing basic requirements', { \r\n        svgRef: !!svgRef.current, \r\n        attentionLength: attention.length, \r\n        tokensLength: tokens.length \r\n      });\r\n      return;\r\n    }\r\n\r\n    console.log('SpiderWeb: Starting render', {\r\n      selectedLayer,\r\n      selectedHead,\r\n      attentionShape: attention.length,\r\n      tokens: tokens.slice(0, 5) // Log first 5 tokens\r\n    });\r\n\r\n    // Clear previous render\r\n    const svg = d3.select(svgRef.current);\r\n    svg.selectAll(\"*\").remove();\r\n\r\n    const width = 800;\r\n    const height = 600;\r\n    const centerX = width / 2;\r\n    const centerY = height / 2;\r\n    const radius = Math.min(width, height) / 2 - 80;\r\n\r\n    // Safely extract attention data with runtime validation\r\n    let attentionData: number[][] = [];\r\n    \r\n    try {\r\n      console.log('SpiderWeb: Checking attention data structure');\r\n      \r\n      if (attention[selectedLayer]) {\r\n        console.log('SpiderWeb: Layer exists, heads:', attention[selectedLayer].length);\r\n        \r\n        if (attention[selectedLayer][selectedHead]) {\r\n          const rawData = attention[selectedLayer][selectedHead];\r\n          console.log('SpiderWeb: Raw attention data:', {\r\n            type: typeof rawData,\r\n            isArray: Array.isArray(rawData),\r\n            length: Array.isArray(rawData) ? rawData.length : 'N/A',\r\n            firstElement: Array.isArray(rawData) && rawData[0] ? typeof rawData[0] : 'N/A'\r\n          });\r\n          \r\n          // Check if it's already a 2D array\r\n          if (Array.isArray(rawData) && rawData.length > 0) {\r\n            if (Array.isArray(rawData[0])) {\r\n              // It's already 2D - explicitly cast to avoid TypeScript error\r\n              attentionData = rawData as unknown as number[][];\r\n              console.log('SpiderWeb: Using 2D attention data, shape:', attentionData.length, 'x', attentionData[0]?.length);\r\n            } else {\r\n              // It might be 1D, let's try to handle it\r\n              console.log('SpiderWeb: Data appears to be 1D, attempting to create identity matrix');\r\n              const numTokens = Math.min(rawData.length, tokens.length);\r\n              attentionData = Array(numTokens).fill(0).map(() => Array(numTokens).fill(0));\r\n              // Create some sample connections for testing\r\n              for (let i = 0; i < numTokens - 1; i++) {\r\n                attentionData[i][i + 1] = 0.5; // Forward connections\r\n                if (i > 0) attentionData[i][i - 1] = 0.3; // Backward connections\r\n              }\r\n            }\r\n          } else {\r\n            console.warn('SpiderWeb: Invalid attention data format');\r\n            return;\r\n          }\r\n        } else {\r\n          console.warn('SpiderWeb: Head not found');\r\n          return;\r\n        }\r\n      } else {\r\n        console.warn('SpiderWeb: Layer not found');\r\n        return;\r\n      }\r\n    } catch (error) {\r\n      console.error('SpiderWeb: Error processing attention data:', error);\r\n      return;\r\n    }\r\n\r\n    if (attentionData.length === 0) {\r\n      console.warn('SpiderWeb: No attention data to visualize');\r\n      return;\r\n    }\r\n\r\n    console.log('SpiderWeb: Successfully processed attention data, shape:', attentionData.length, 'x', attentionData[0]?.length);\r\n\r\n    // Position tokens in a circle\r\n    const tokenPositions: TokenPosition[] = tokens.map((token, i) => {\r\n      const angle = (2 * Math.PI * i) / tokens.length - Math.PI / 2;\r\n      return {\r\n        x: centerX + radius * Math.cos(angle),\r\n        y: centerY + radius * Math.sin(angle),\r\n        token: token,\r\n        index: i\r\n      };\r\n    });\r\n\r\n    console.log('SpiderWeb: Token positions calculated:', tokenPositions.length);\r\n\r\n    // Create container group\r\n    const g = svg.append('g');\r\n\r\n    // Find maximum attention value for scaling\r\n    let maxAttention = 0;\r\n    let connectionCount = 0;\r\n    \r\n    for (let i = 0; i < attentionData.length; i++) {\r\n      const row = attentionData[i];\r\n      if (Array.isArray(row)) {\r\n        for (let j = 0; j < row.length; j++) {\r\n          const val = row[j];\r\n          if (typeof val === 'number' && !isNaN(val) && val > maxAttention) {\r\n            maxAttention = val;\r\n          }\r\n          if (typeof val === 'number' && !isNaN(val) && val > 0) {\r\n            connectionCount++;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    console.log('SpiderWeb: Max attention:', maxAttention, 'Total connections:', connectionCount);\r\n\r\n    if (maxAttention === 0) {\r\n      console.warn('SpiderWeb: No positive attention values found');\r\n      // Let's add some test connections to verify the visualization works\r\n      maxAttention = 1.0;\r\n      attentionData[0][1] = 0.8;\r\n      attentionData[1][2] = 0.6;\r\n      if (attentionData.length > 2) {\r\n        attentionData[2][0] = 0.4;\r\n      }\r\n      console.log('SpiderWeb: Added test connections');\r\n    }\r\n\r\n    const minThreshold = maxAttention * 0.05; // Only show connections above 5% of max\r\n    let drawnConnections = 0;\r\n\r\n    // Draw attention connections\r\n    for (let fromIdx = 0; fromIdx < attentionData.length && fromIdx < tokenPositions.length; fromIdx++) {\r\n      const fromAttentions = attentionData[fromIdx];\r\n      if (!Array.isArray(fromAttentions)) continue;\r\n      \r\n      for (let toIdx = 0; toIdx < fromAttentions.length && toIdx < tokenPositions.length; toIdx++) {\r\n        const attentionWeight = fromAttentions[toIdx];\r\n        \r\n        if (typeof attentionWeight !== 'number' || isNaN(attentionWeight)) continue;\r\n        if (attentionWeight <= minThreshold) continue;\r\n\r\n        const from = tokenPositions[fromIdx];\r\n        const to = tokenPositions[toIdx];\r\n        const opacity = Math.min(1, attentionWeight / maxAttention);\r\n        const strokeWidth = Math.max(1, opacity * 8);\r\n\r\n        g.append('line')\r\n          .attr('x1', from.x)\r\n          .attr('y1', from.y)\r\n          .attr('x2', to.x)\r\n          .attr('y2', to.y)\r\n          .attr('stroke', `rgba(33, 150, 243, ${opacity})`)\r\n          .attr('stroke-width', strokeWidth)\r\n          .attr('class', 'attention-connection')\r\n          .style('pointer-events', 'none');\r\n        \r\n        drawnConnections++;\r\n      }\r\n    }\r\n\r\n    console.log('SpiderWeb: Drew', drawnConnections, 'connections');\r\n\r\n    // Always draw token nodes\r\n    const nodes = g.selectAll('.token-node')\r\n      .data(tokenPositions)\r\n      .enter()\r\n      .append('g')\r\n      .attr('class', 'token-node')\r\n      .attr('transform', (d: TokenPosition) => `translate(${d.x}, ${d.y})`);\r\n\r\n    // Add circles for tokens\r\n    nodes.append('circle')\r\n      .attr('r', 20)\r\n      .attr('fill', '#2196F3')\r\n      .attr('stroke', '#fff')\r\n      .attr('stroke-width', 2)\r\n      .style('cursor', 'pointer');\r\n\r\n    // Add token text\r\n    nodes.append('text')\r\n      .text((d: TokenPosition) => d.token.length > 6 ? d.token.substring(0, 6) + '...' : d.token)\r\n      .attr('text-anchor', 'middle')\r\n      .attr('dy', '0.3em')\r\n      .attr('fill', '#fff')\r\n      .attr('font-size', '10px')\r\n      .attr('font-weight', 'bold')\r\n      .style('pointer-events', 'none');\r\n\r\n    console.log('SpiderWeb: Drew', tokenPositions.length, 'token nodes');\r\n\r\n    // Add hover effects\r\n    nodes\r\n      .on('mouseover', function(event: any, d: TokenPosition) {\r\n        d3.select(this).select('circle')\r\n          .transition()\r\n          .duration(200)\r\n          .attr('r', 25)\r\n          .attr('fill', '#21CBF3');\r\n        \r\n        // Show tooltip\r\n        d3.select('body').append('div')\r\n          .attr('class', 'spider-tooltip')\r\n          .style('position', 'absolute')\r\n          .style('background', 'rgba(0, 0, 0, 0.8)')\r\n          .style('color', '#fff')\r\n          .style('padding', '8px')\r\n          .style('border-radius', '4px')\r\n          .style('font-size', '12px')\r\n          .style('pointer-events', 'none')\r\n          .style('z-index', '1000')\r\n          .style('left', (event.pageX + 10) + 'px')\r\n          .style('top', (event.pageY - 10) + 'px')\r\n          .text(`Token: \"${d.token}\" (Position: ${d.index})`);\r\n      })\r\n      .on('mouseout', function() {\r\n        d3.select(this).select('circle')\r\n          .transition()\r\n          .duration(200)\r\n          .attr('r', 20)\r\n          .attr('fill', '#2196F3');\r\n        \r\n        d3.selectAll('.spider-tooltip').remove();\r\n      });\r\n\r\n    // Add center label\r\n    g.append('text')\r\n      .attr('x', centerX)\r\n      .attr('y', centerY - 10)\r\n      .attr('text-anchor', 'middle')\r\n      .attr('fill', '#aaa')\r\n      .attr('font-size', '14px')\r\n      .text(`Layer ${selectedLayer + 1}, Head ${selectedHead + 1}`);\r\n\r\n    g.append('text')\r\n      .attr('x', centerX)\r\n      .attr('y', centerY + 10)\r\n      .attr('text-anchor', 'middle')\r\n      .attr('fill', '#aaa')\r\n      .attr('font-size', '12px')\r\n      .text('Attention Flow Network');\r\n\r\n    console.log('SpiderWeb: Visualization complete');\r\n  }, [attention, tokens, selectedLayer, selectedHead]);\r\n\r\n  return (\r\n    <Paper \r\n      elevation={2} \r\n      sx={{ \r\n        p: 2, \r\n        mb: 3, \r\n        bgcolor: '#1e1e1e',\r\n        border: '1px solid #333'\r\n      }}\r\n    >\r\n      <Typography variant=\"h6\" sx={{ mb: 2, color: '#fff' }}>\r\n        Attention Spider Web\r\n      </Typography>\r\n      <Typography variant=\"body2\" sx={{ mb: 2, color: '#aaa' }}>\r\n        Network visualization showing attention connections between tokens. \r\n        Line thickness and opacity represent attention strength.\r\n      </Typography>\r\n      <svg\r\n        ref={svgRef}\r\n        width=\"100%\"\r\n        height=\"600\"\r\n        viewBox=\"0 0 800 600\"\r\n        style={{ background: '#0a0a0a', borderRadius: '4px' }}\r\n      />\r\n    </Paper>\r\n  );\r\n};\r\n\r\nexport default AttentionSpiderWeb; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}